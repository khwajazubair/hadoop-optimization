2013-08-20 16:14:37,926 WARN [main] org.apache.hadoop.util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2013-08-20 16:14:37,978 ERROR [main] org.apache.hadoop.util.Shell: Failed to detect a valid hadoop home directory
java.io.IOException: HADOOP_HOME or hadoop.home.dir are not set.
	at org.apache.hadoop.util.Shell.checkHadoopHome(Shell.java:163)
	at org.apache.hadoop.util.Shell.<clinit>(Shell.java:186)
	at org.apache.hadoop.util.StringUtils.<clinit>(StringUtils.java:77)
	at org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:91)
2013-08-20 16:14:38,175 INFO [main] org.apache.hadoop.metrics2.impl.MetricsConfig: loaded properties from hadoop-metrics2.properties
2013-08-20 16:14:38,317 INFO [main] org.apache.hadoop.metrics2.impl.MetricsSystemImpl: Scheduled snapshot period at 10 second(s).
2013-08-20 16:14:38,317 INFO [main] org.apache.hadoop.metrics2.impl.MetricsSystemImpl: ReduceTask metrics system started
2013-08-20 16:14:38,343 INFO [main] org.apache.hadoop.mapred.YarnChild: Executing with tokens:
2013-08-20 16:14:38,343 INFO [main] org.apache.hadoop.mapred.YarnChild: Kind: mapreduce.job, Service: job_1377014248033_0007, Ident: (org.apache.hadoop.mapreduce.security.token.JobTokenIdentifier@3a5f5a46)
2013-08-20 16:14:38,469 INFO [main] org.apache.hadoop.mapred.YarnChild: Sleeping for 0ms before retrying again. Got null now.
2013-08-20 16:14:40,328 INFO [main] org.apache.hadoop.mapred.YarnChild: mapreduce.cluster.local.dir for child: /mnt/hdfs-tmp/nm-local-dir/usercache/ubuntu/appcache/application_1377014248033_0007
2013-08-20 16:14:40,873 WARN [main] org.apache.hadoop.conf.Configuration: mapred.task.id is deprecated. Instead, use mapreduce.task.attempt.id
2013-08-20 16:14:40,873 WARN [main] org.apache.hadoop.conf.Configuration: mapred.task.is.map is deprecated. Instead, use mapreduce.task.ismap
2013-08-20 16:14:40,874 WARN [main] org.apache.hadoop.conf.Configuration: mapred.tip.id is deprecated. Instead, use mapreduce.task.id
2013-08-20 16:14:40,874 WARN [main] org.apache.hadoop.conf.Configuration: mapred.task.partition is deprecated. Instead, use mapreduce.task.partition
2013-08-20 16:14:40,875 WARN [main] org.apache.hadoop.conf.Configuration: mapred.local.dir is deprecated. Instead, use mapreduce.cluster.local.dir
2013-08-20 16:14:40,876 WARN [main] org.apache.hadoop.conf.Configuration: job.local.dir is deprecated. Instead, use mapreduce.job.local.dir
2013-08-20 16:14:40,876 WARN [main] org.apache.hadoop.conf.Configuration: mapred.map.tasks is deprecated. Instead, use mapreduce.job.maps
2013-08-20 16:14:40,876 WARN [main] org.apache.hadoop.conf.Configuration: mapred.cache.localFiles is deprecated. Instead, use mapreduce.job.cache.local.files
2013-08-20 16:14:40,876 WARN [main] org.apache.hadoop.conf.Configuration: mapred.job.id is deprecated. Instead, use mapreduce.job.id
2013-08-20 16:14:41,064 WARN [main] org.apache.hadoop.conf.Configuration: session.id is deprecated. Instead, use dfs.metrics.session-id
2013-08-20 16:14:41,548 INFO [main] org.apache.hadoop.mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2013-08-20 16:14:41,647 INFO [main] org.apache.hadoop.mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@18b3f8f5
2013-08-20 16:14:41,676 INFO [main] org.apache.hadoop.mapreduce.task.reduce.MergeManagerImpl: MergerManager: memoryLimit=130514944, maxSingleShuffleLimit=32628736, mergeThreshold=86139864, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2013-08-20 16:14:41,679 INFO [EventFetcher for fetching Map Completion Events] org.apache.hadoop.mapreduce.task.reduce.EventFetcher: attempt_1377014248033_0007_r_000006_1 Thread started: EventFetcher for fetching Map Completion Events
2013-08-20 16:14:41,698 INFO [fetcher#3] org.apache.hadoop.mapreduce.task.reduce.ShuffleScheduler: Assiging hadoop-999-2:8080 with 1 to fetcher#3
2013-08-20 16:14:41,698 INFO [fetcher#3] org.apache.hadoop.mapreduce.task.reduce.ShuffleScheduler: assigned 1 of 1 to hadoop-999-2:8080 to fetcher#3
2013-08-20 16:14:41,698 INFO [fetcher#1] org.apache.hadoop.mapreduce.task.reduce.ShuffleScheduler: Assiging hadoop-999-4:8080 with 1 to fetcher#1
2013-08-20 16:14:41,700 INFO [fetcher#1] org.apache.hadoop.mapreduce.task.reduce.ShuffleScheduler: assigned 1 of 1 to hadoop-999-4:8080 to fetcher#1
2013-08-20 16:14:41,704 INFO [EventFetcher for fetching Map Completion Events] org.apache.hadoop.mapreduce.task.reduce.EventFetcher: attempt_1377014248033_0007_r_000006_1: Got 40 new map-outputs
2013-08-20 16:14:41,705 INFO [fetcher#2] org.apache.hadoop.mapreduce.task.reduce.ShuffleScheduler: Assiging hadoop-999-7:8080 with 5 to fetcher#2
2013-08-20 16:14:41,706 INFO [fetcher#2] org.apache.hadoop.mapreduce.task.reduce.ShuffleScheduler: assigned 5 of 5 to hadoop-999-7:8080 to fetcher#2
2013-08-20 16:14:41,706 INFO [fetcher#4] org.apache.hadoop.mapreduce.task.reduce.ShuffleScheduler: Assiging hadoop-999-5:8080 with 6 to fetcher#4
2013-08-20 16:14:41,706 INFO [fetcher#4] org.apache.hadoop.mapreduce.task.reduce.ShuffleScheduler: assigned 6 of 6 to hadoop-999-5:8080 to fetcher#4
2013-08-20 16:14:41,718 INFO [fetcher#5] org.apache.hadoop.mapreduce.task.reduce.ShuffleScheduler: Assiging hadoop-999-3:8080 with 7 to fetcher#5
2013-08-20 16:14:41,718 INFO [fetcher#5] org.apache.hadoop.mapreduce.task.reduce.ShuffleScheduler: assigned 7 of 7 to hadoop-999-3:8080 to fetcher#5
2013-08-20 16:14:41,971 INFO [fetcher#4] org.apache.hadoop.mapreduce.task.reduce.Fetcher: for url=8080/mapOutput?job=job_1377014248033_0007&reduce=6&map=attempt_1377014248033_0007_m_000000_0,attempt_1377014248033_0007_m_000004_0,attempt_1377014248033_0007_m_000006_0,attempt_1377014248033_0007_m_000019_0,attempt_1377014248033_0007_m_000022_0,attempt_1377014248033_0007_m_000036_0 sent hash and received reply
2013-08-20 16:14:41,973 INFO [fetcher#3] org.apache.hadoop.mapreduce.task.reduce.Fetcher: for url=8080/mapOutput?job=job_1377014248033_0007&reduce=6&map=attempt_1377014248033_0007_m_000002_0 sent hash and received reply
2013-08-20 16:14:41,988 INFO [fetcher#3] org.apache.hadoop.mapreduce.task.reduce.Fetcher: fetcher#3 about to shuffle output of map attempt_1377014248033_0007_m_000002_0 decomp: 13851034 len: 13851038 to MEMORY
2013-08-20 16:14:41,994 INFO [fetcher#2] org.apache.hadoop.mapreduce.task.reduce.Fetcher: for url=8080/mapOutput?job=job_1377014248033_0007&reduce=6&map=attempt_1377014248033_0007_m_000005_0,attempt_1377014248033_0007_m_000014_0,attempt_1377014248033_0007_m_000013_0,attempt_1377014248033_0007_m_000032_0,attempt_1377014248033_0007_m_000038_0 sent hash and received reply
2013-08-20 16:14:41,995 INFO [fetcher#5] org.apache.hadoop.mapreduce.task.reduce.Fetcher: for url=8080/mapOutput?job=job_1377014248033_0007&reduce=6&map=attempt_1377014248033_0007_m_000007_0,attempt_1377014248033_0007_m_000012_0,attempt_1377014248033_0007_m_000015_0,attempt_1377014248033_0007_m_000021_0,attempt_1377014248033_0007_m_000024_0,attempt_1377014248033_0007_m_000028_0,attempt_1377014248033_0007_m_000039_0 sent hash and received reply
2013-08-20 16:14:41,995 INFO [fetcher#1] org.apache.hadoop.mapreduce.task.reduce.Fetcher: for url=8080/mapOutput?job=job_1377014248033_0007&reduce=6&map=attempt_1377014248033_0007_m_000001_0 sent hash and received reply
2013-08-20 16:14:42,097 INFO [fetcher#5] org.apache.hadoop.mapreduce.task.reduce.Fetcher: fetcher#5 about to shuffle output of map attempt_1377014248033_0007_m_000007_0 decomp: 13862266 len: 13862270 to MEMORY
2013-08-20 16:14:42,105 INFO [fetcher#1] org.apache.hadoop.mapreduce.task.reduce.Fetcher: fetcher#1 about to shuffle output of map attempt_1377014248033_0007_m_000001_0 decomp: 13825450 len: 13825454 to MEMORY
2013-08-20 16:14:42,115 INFO [fetcher#2] org.apache.hadoop.mapreduce.task.reduce.Fetcher: fetcher#2 about to shuffle output of map attempt_1377014248033_0007_m_000005_0 decomp: 13864034 len: 13864038 to MEMORY
2013-08-20 16:14:42,142 INFO [fetcher#4] org.apache.hadoop.mapreduce.task.reduce.Fetcher: fetcher#4 about to shuffle output of map attempt_1377014248033_0007_m_000000_0 decomp: 13834498 len: 13834502 to MEMORY
2013-08-20 16:14:42,856 INFO [fetcher#4] org.apache.hadoop.mapreduce.task.reduce.InMemoryMapOutput: Read 13834498 bytes from map-output for attempt_1377014248033_0007_m_000000_0
2013-08-20 16:14:42,859 INFO [fetcher#4] org.apache.hadoop.mapreduce.task.reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 13834498, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->69237282
2013-08-20 16:14:43,212 INFO [fetcher#4] org.apache.hadoop.mapreduce.task.reduce.Fetcher: fetcher#4 about to shuffle output of map attempt_1377014248033_0007_m_000004_0 decomp: 13803402 len: 13803406 to MEMORY
2013-08-20 16:14:43,660 INFO [fetcher#4] org.apache.hadoop.mapreduce.task.reduce.InMemoryMapOutput: Read 13803402 bytes from map-output for attempt_1377014248033_0007_m_000004_0
2013-08-20 16:14:43,661 INFO [fetcher#4] org.apache.hadoop.mapreduce.task.reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 13803402, inMemoryMapOutputs.size() -> 2, commitMemory -> 13834498, usedMemory ->83040684
2013-08-20 16:14:43,665 INFO [fetcher#4] org.apache.hadoop.mapreduce.task.reduce.Fetcher: fetcher#4 about to shuffle output of map attempt_1377014248033_0007_m_000006_0 decomp: 13923210 len: 13923214 to MEMORY
2013-08-20 16:14:43,717 INFO [fetcher#4] org.apache.hadoop.mapreduce.task.reduce.InMemoryMapOutput: Read 13923210 bytes from map-output for attempt_1377014248033_0007_m_000006_0
2013-08-20 16:14:43,717 INFO [fetcher#4] org.apache.hadoop.mapreduce.task.reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 13923210, inMemoryMapOutputs.size() -> 3, commitMemory -> 27637900, usedMemory ->96963894
2013-08-20 16:14:43,721 INFO [fetcher#4] org.apache.hadoop.mapreduce.task.reduce.Fetcher: fetcher#4 about to shuffle output of map attempt_1377014248033_0007_m_000019_0 decomp: 13881714 len: 13881718 to MEMORY
2013-08-20 16:14:43,907 INFO [fetcher#4] org.apache.hadoop.mapreduce.task.reduce.InMemoryMapOutput: Read 13881714 bytes from map-output for attempt_1377014248033_0007_m_000019_0
2013-08-20 16:14:43,907 INFO [fetcher#4] org.apache.hadoop.mapreduce.task.reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 13881714, inMemoryMapOutputs.size() -> 4, commitMemory -> 41561110, usedMemory ->110845608
2013-08-20 16:14:43,912 INFO [fetcher#4] org.apache.hadoop.mapreduce.task.reduce.Fetcher: fetcher#4 about to shuffle output of map attempt_1377014248033_0007_m_000022_0 decomp: 13814530 len: 13814534 to MEMORY
2013-08-20 16:14:44,048 INFO [fetcher#3] org.apache.hadoop.mapreduce.task.reduce.InMemoryMapOutput: Read 13851034 bytes from map-output for attempt_1377014248033_0007_m_000002_0
2013-08-20 16:14:44,051 INFO [fetcher#3] org.apache.hadoop.mapreduce.task.reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 13851034, inMemoryMapOutputs.size() -> 5, commitMemory -> 55442824, usedMemory ->124660138
2013-08-20 16:14:44,053 INFO [fetcher#3] org.apache.hadoop.mapreduce.task.reduce.ShuffleScheduler: hadoop-999-2:8080 freed by fetcher#3 in 2355s
2013-08-20 16:14:44,053 INFO [fetcher#3] org.apache.hadoop.mapreduce.task.reduce.ShuffleScheduler: Assiging hadoop-999-2:8080 with 7 to fetcher#3
2013-08-20 16:14:44,053 INFO [fetcher#3] org.apache.hadoop.mapreduce.task.reduce.ShuffleScheduler: assigned 7 of 7 to hadoop-999-2:8080 to fetcher#3
2013-08-20 16:14:44,059 INFO [fetcher#3] org.apache.hadoop.mapreduce.task.reduce.Fetcher: for url=8080/mapOutput?job=job_1377014248033_0007&reduce=6&map=attempt_1377014248033_0007_m_000003_0,attempt_1377014248033_0007_m_000010_0,attempt_1377014248033_0007_m_000009_0,attempt_1377014248033_0007_m_000016_0,attempt_1377014248033_0007_m_000025_0,attempt_1377014248033_0007_m_000030_0,attempt_1377014248033_0007_m_000034_0 sent hash and received reply
2013-08-20 16:14:44,244 INFO [fetcher#3] org.apache.hadoop.mapreduce.task.reduce.Fetcher: fetcher#3 about to shuffle output of map attempt_1377014248033_0007_m_000003_0 decomp: 13798410 len: 13798414 to MEMORY
